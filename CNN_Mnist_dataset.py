# -*- coding: utf-8 -*-
"""LAB_14_IITKanpur.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1zSL_AW618pqqwKq9SArGiaIEkKSwyKpW
"""

import tensorflow as tf
from tensorflow import keras
from keras.datasets import fashion_mnist
from keras.datasets import mnist
import numpy as np
import numpy.random as nr
import matplotlib.pyplot as plt
from keras.models import Sequential
from keras.layers import Dense
from sklearn.metrics import accuracy_score
from keras.layers import Conv2D, Flatten
nc = 10

(Xtrain,ytrain), (Xtest,ytest) = mnist.load_data()

imgplot1 = plt.imshow(Xtrain[nr.randint(60000)])
plt.show()

imgplot2 = plt.imshow(Xtrain[nr.randint(60000)])
plt.show()

Xtrain = Xtrain.reshape(60000,28,28,1)
Xtest = Xtest.reshape(10000,28,28,1)

ytrainEnc = tf.one_hot(ytrain,depth = nc)
ytestEnc = tf.one_hot(ytest,depth = nc)

model = Sequential()
model.add(Conv2D(64,kernel_size = 3, activation = "relu", input_shape = (28,28,1)))
model.add(Conv2D(32,kernel_size = 3, activation = "relu"))
model.add(Flatten())
model.add(Dense(10,activation = "softmax"))
model.compile(loss = "categorical_crossentropy", optimizer = "adam", metrics = ["accuracy"])
model.fit(Xtrain,ytrainEnc,validation_data = (Xtest,ytestEnc), epochs = 3)